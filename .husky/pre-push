#!/usr/bin/env sh

# Fix Git hook output display issues (for Git 2.36.0+)
if sh -c ": >/dev/tty" >/dev/null 2>/dev/null; then exec >/dev/tty 2>&1; fi

set -e

# Ensure adequate Node heap for tests/build
export NODE_OPTIONS="${NODE_OPTIONS:---max-old-space-size=4096}"

# Run TypeScript type checking
pnpm type-check

# Run tests (serial; heap increased via NODE_OPTIONS and package script)
pnpm test

# Run production build to ensure build integrity
pnpm build
